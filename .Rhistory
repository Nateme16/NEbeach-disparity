#Creating Beach Visitation for New England with first and missing days from Airsage#
library(here)
library(gtools)
library(dplyr)
library(R.utils)
library(readr)
file_list <- list.files(pattern="poi_summary*", recursive = TRUE)
file_list
load("data/trips_by_blockgroup_yearly_NewEngland_oct22.Rdata")
View(trips_by_blockgroup_yearly)
unique(trips_by_blockgroup_yearly$year)
test=trips_by_blockgroup_yearly[trips_by_blockgroup_yearly$year=="2018",]
View(test)
#2018
write.csv(trips_by_blockgroup_yearly[trips_by_blockgroup_yearly$year=="2018",],"Data/trips_by_blockgroup_yearly_2018_NewEngland_oct22.csv")
save(trips_by_blockgroup_yearly,file="Data/trips_by_blockgroup_yearly_2018NewEngland_oct22.Rdata")
#2019
write.csv(trips_by_blockgroup_yearly[trips_by_blockgroup_yearly$year=="2019",],"Data/trips_by_blockgroup_yearly_2019_NewEngland_oct22.csv")
save(trips_by_blockgroup_yearly,file="Data/trips_by_blockgroup_yearly_2019_NewEngland_oct22.Rdata")
View(test)
dirname("~")
Sys.getenv("USERNAME")
Sys.getenv("HOME")
#Creating Beach Visitation for New England with first and missing days from Airsage#
library(here)
library(gtools)
library(dplyr)
library(R.utils)
library(readr)
rm(list=ls()) #clear all
####Create POI summary info for all months together####
#build path to data files sensitive to usernames in OneDrive link
wd= paste("C:/Users/",Sys.getenv("USERNAME"),"/Environmental Protection Agency (EPA)/ACESD Social Science Team - General/Research Projects/Beach research STRAP4/New England beach cell data/NEbeach-disparity/data", sep = "")
setwd(wd)
#Create WQ variable from beacon data
library(here)
rm(list=ls()) #clear all
####Create POI summary info for all months together####
#build path to data files sensitive to usernames in OneDrive link
#wd= paste("C:/Users/",Sys.getenv("USERNAME"),"/Environmental Protection Agency (EPA)/ACESD Social Science Team - General/Research Projects/Beach research STRAP4/New England beach cell data/NEbeach-disparity/data", sep = "")
#setwd(wd)
bacteria=read.csv("data/resultphyschem.csv")
bacteria=read.csv("data/bacteria_poi_join.csv")
View(bacteria)
colnames(bacteria)
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
View(bacteria)
bacteria=read.csv("data/bacteria_poi_join.csv")
View(bacteria)
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu=bacteria$ResultMeasureValue
bacteria$cfu[bacteria$cfu==""]=0
bacteria$YEAR <- as.character(substr(bacteria$DATE, 1, 4))
bacteria$YEAR <- as.character(substr(bacteria$ActivityStartDate, 1, 4))
bacteria$MONTH <- as.character(substr(bacteria$ActivityStartDate, 6, 7))
bacteria$DAY <- as.character(substr(bacteria$ActivityStartDate, 9, 10))
#setwd(wd)
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu=bacteria$ResultMeasureValue
bacteria$cfu[bacteria$cfu==""]=0
bacteria$poi=bacteria$Unique_ID
bacteria$year <- as.character(substr(bacteria$ActivityStartDate, 1, 4))
bacteria$month <- as.character(substr(bacteria$ActivityStartDate, 6, 7))
bacteria$day <- as.character(substr(bacteria$ActivityStartDate, 9, 10))
bacteria=bacteria[,c("poi","cfu","year","month","day")]
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu=as.numeric(bacteria$ResultMeasureValue)
bacteria=bacteria[!is.na(bacteria$cfu),]
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu=as.numeric(bacteria$ResultMeasureValue)
bacteria$cfu[bacteria$cfu==""]=0
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu[bacteria$cfu==""]=0
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$cfu[bacteria$ActivityStartDate==""]=0
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$ActivityStartDate[bacteria$ActivityStartDate==""]=0
bacteria=read.csv("data/bacteria_poi_join.csv")
bacteria=bacteria[,c("ActivityStartDate","ResultMeasureValue","Unique_ID" )]
bacteria$ResultMeasureValue[bacteria$ResultMeasureValue==""]=0
bacteria$cfu=as.numeric(bacteria$ResultMeasureValue)
bacteria=bacteria[!is.na(bacteria$cfu),]
bacteria$poi=bacteria$Unique_ID
bacteria$year <- as.character(substr(bacteria$ActivityStartDate, 1, 4))
bacteria$month <- as.character(substr(bacteria$ActivityStartDate, 6, 7))
bacteria$day <- as.character(substr(bacteria$ActivityStartDate, 9, 10))
bacteria=bacteria[,c("poi","cfu","year","month","day")]
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(across(everything(), mean))
library(dplyr)
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(across(everything(), mean))
View(bacteria2)
bacteria2=bacteria2[,c("poi","cfu","year")]
View(bacteria2)
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(cfu=mean(cfu),
n=n(),
exceed100=sum(cfu>100),
exceed100perc=exceed100/n)
View(bacteria2)
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(cfu=mean(cfu),
n=n(),
exceed100=sum(cfu > 100),
exceed100perc=exceed100/n)
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(cfu2=mean(cfu),
n=n(),
exceed100=sum(cfu > 100),
exceed100perc=exceed100/n)
#collapse to year
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(cfu2=mean(cfu),
n=n(),
exceed100=sum(cfu > 100),
exceed100perc=exceed100/n)
bacteria2=bacteria2[,c("poi","cfu2","exceed100","exceed100perc","year")]
View(bacteria2)
#collapse to year
bacteria2= bacteria %>%
group_by(poi,year) %>%
summarise(cfu2=mean(cfu),
n=n(),
exceed100=sum(cfu > 100),
exceed100perc=exceed100/n)
bacteria2=bacteria2[,c("poi","cfu2","exceed100","exceed100perc","n","year")]
View(bacteria2)
write.csv("Data/bacteria_yearly.csv")
write.csv(bacteria2,"Data/bacteria_yearly.csv")
